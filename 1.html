<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>写给你的情书</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      background: linear-gradient(to right, #fbc2eb, #a6c1ee);
      font-family: "Courier New", Courier, monospace;
    }

    #heart {
      position: fixed;
      z-index: 1;
    }

    .typing {
      position: absolute;
      top: 20%;
      width: 80%;
      left: 10%;
      color: white;
      font-size: 24px;
      line-height: 1.8;
      z-index: 10;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
    }

    .heart {
      width: 10px;
      height: 10px;
      position: fixed;
      background: red;
      transform: rotate(45deg);
      animation: fade 1.2s linear;
    }

    .heart:before,
    .heart:after {
      content: "";
      width: 10px;
      height: 10px;
      background: red;
      border-radius: 50%;
      position: absolute;
    }

    .heart:before {
      top: -5px;
      left: 0;
    }

    .heart:after {
      left: -5px;
      top: 0;
    }

    @keyframes fade {
      0% { opacity: 1; transform: scale(1) rotate(45deg); }
      100% { opacity: 0; transform: scale(3) rotate(45deg); top: -100px; }
    }
  </style>
</head>
<body>

<canvas id="heart"></canvas>

<div class="typing" id="text"></div>

<audio autoplay loop>
  <source src="https://cdn.pixabay.com/audio/2023/03/22/audio_3c5f186bf3.mp3" type="audio/mpeg">
</audio>

<script>
  // 打字效果
  const content = `亲爱的你：

从遇见你的那一刻起，我的世界开始有了光。
你笑的样子，是我永远的温柔牵挂。
愿未来的日子，风景有你，万事胜意。

爱你的人 ❤️`;
  const textBox = document.getElementById("text");
  let i = 0;
  function typeWriter() {
    if (i < content.length) {
      let char = content.charAt(i);
      textBox.innerHTML += char === "\n" ? "<br/>" : char;
      i++;
      setTimeout(typeWriter, 70);
    }
  }
  typeWriter();

  // 飘爱心效果
  document.addEventListener("click", function(e) {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.style.left = e.clientX + "px";
    heart.style.top = e.clientY + "px";
    document.body.appendChild(heart);
    setTimeout(() => document.body.removeChild(heart), 1200);
  });

  // 花瓣雨效果
  const canvas = document.getElementById('heart');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  const petals = [];

  function Petal() {
    this.x = Math.random() * canvas.width;
    this.y = Math.random() * -canvas.height;
    this.radius = Math.random() * 10 + 5;
    this.speedY = Math.random() * 2 + 1;
    this.speedX = Math.random() * 1 - 0.5;
    this.alpha = Math.random() * 0.5 + 0.5;

    this.draw = function () {
      ctx.beginPath();
      ctx.fillStyle = `rgba(255,182,193,${this.alpha})`; // 粉色花瓣
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
      ctx.fill();
    };

    this.update = function () {
      this.y += this.speedY;
      this.x += this.speedX;
      if (this.y > canvas.height) {
        this.y = -10;
        this.x = Math.random() * canvas.width;
      }
      this.draw();
    };
  }

  function initPetals() {
    for (let i = 0; i < 100; i++) {
      petals.push(new Petal());
    }
  }

  function animatePetals() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    petals.forEach(petal => petal.update());
    requestAnimationFrame(animatePetals);
  }

  initPetals();
  animatePetals();
</script>

</body>
</html>
